<div
  class="container"
  *ngIf="open"
  [@fadeEnter]="{
    value: '',
    params: { duration: 300, delay: 0 }
  }"
  [@fadeOutLeave]="{
    value: '',
    params: { duration: 300, delay: 0 }
  }"
>
  <div class="optionsMenuBackdrop"></div>
  <div class="overlayBox">
    <img class="overlayPanelBg" src="./assets/wideMenu.png" />
    <div class="overlalPanelTitle">Deck</div>
    <div class="menuBtnBox">
      <div class="menuBtnRelative" (click)="saveDeck()">
        <img src="./assets/menuBtn.png" class="menuBtn" />
        <div class="doneText">Save</div>
      </div>
    </div>
    <!-- Floating text -->
    <div class="floatingText">
      <div class="floatingRelative" *ngFor="let item of errorList">
        <div
          class="floatingTextMessage"
          [ngClass]="{
            fade: errorListInactive.includes(item.id)
          }"
          [@zoomInEnter]="{
            value: '',
            params: { duration: 1000, delay: 0, translate: '30px' }
          }"
          [@fadeOutLeave]
        >
          {{ item.message }}
        </div>
      </div>
    </div>
    <div class="absoluteLeftSide">
      <div class="boxRelativeSide">
        <img src="./assets/leftBox.png" />
        <div class="absoluteCardsSortBtn">
          <div
            class="relativeBoxContainer relativeBoxContainerHover"
            (click)="nextSort()"
          >
            <img src="./assets/button.png" />
            <div class="btnText">Sort By</div>
          </div>
        </div>
        <div class="absoluteCardsSortText">
          <div class="relativeBoxContainer">
            <img src="./assets/shopBtnBg.png" />
            <div class="displayText">{{ currentSort }}</div>
          </div>
        </div>
        <div class="cardsListBox">
          <div class="cardsList fancyScrollBar">
            <div
              class="bottomCard playerBottomCard"
              *ngFor="let card of abilityCards; index as i; trackBy: trackById"
              #activeAbilityCards
              (dblclick)="addCardToHand(card)"
              (mouseenter)="setIsNewFalseCard(card)"
              (mouseleave)="currentUpgradeHover = undefined"
              [ngClass]="{
                darkenCard: !card.owned || (card.inHand && card.owned)
              }"
            >
              <div class="cardBorder">
                <img
                  [src]="'./assets/abilities/' + card.image"
                  class="cardBackgroundImage"
                />
                <div class="wildCardSuites bottomWildCard bottomAbilityStuff">
                  <div
                    class="newImageBox"
                    [ngClass]="{
                      fadeInNew: card.isNew,
                      fadeOutNew: !card.isNew,
                    }"
                  >
                    <img src="./assets/new.png" class="newImage" />
                  </div>
                  <div
                    class="abilityTitle"
                    [ngClass]="{
                    paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                  }"
                  >
                    <div class="abilityTitleText">
                      {{ card.name }}
                      {{ card.level > 1 ? "+" + (card.level - 1) : "" }}
                    </div>
                    <div class="abilitySuitsBox">
                      <img
                        *ngFor="let cost of card.cost"
                        [src]="'./assets/' + cost + '.png'"
                        class="abilitySuit"
                      />
                    </div>
                  </div>
                  <div
                    class="abilityBorder1"
                    [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                  }"
                  ></div>
                  <div
                    class="abilityBorder2"
                    [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                  }"
                  ></div>
                  <div class="cardCount" *ngIf="card.numberOwned > 0">
                    <b class="smaller">x</b>{{ card.numberOwned }}
                  </div>
                  <div
                    class="abilityDescription"
                    [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                  }"
                  >
                    <div class="abilityDescriptionText">
                      {{ card.description }}
                    </div>
                  </div>
                </div>
              </div>
              <div
                class="upgradeBox"
                [ngClass]="{
                  upgradeBoxFinished: card.trueNumberOwned > 2
                }"
              >
                <div class="upgradeBg"></div>
                <div
                  class="upgradeBgFill"
                  [ngClass]="{
                    upgradeBgFinishedFill: card.trueNumberOwned > 2
                  }"
                  [ngStyle]="{
                    width: determineWidth(card)
                  }"
                ></div>
                <img
                  class="upgradeArrow"
                  src="./assets/blueArrow.png"
                  *ngIf="card.trueNumberOwned <= 2"
                />
                <img
                  class="upgradeArrow"
                  src="./assets/greenArrow.png"
                  *ngIf="card.trueNumberOwned > 2"
                />
                <div
                  class="upgradeText"
                  *ngIf="
                    card.trueNumberOwned <= 2 ||
                    currentUpgradeHover?.id !== card.id
                  "
                >
                  {{ card.trueNumberOwned }}/3
                </div>
                <div
                  class="upgradeText goldText"
                  *ngIf="
                    card.trueNumberOwned > 2 &&
                    currentUpgradeHover?.id === card.id
                  "
                >
                  {{ card.goldCost[card.level] }}
                </div>
                <img
                  src="./assets/gold.png"
                  *ngIf="
                    card.trueNumberOwned > 2 &&
                    currentUpgradeHover?.id === card.id
                  "
                  class="goldCostImg"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="absoluteRightSide">
      <div class="boxRelativeSide">
        <img src="./assets/rightBox.png" />
        <div class="absoluteCardsSortBtn">
          <div
            class="relativeBoxContainer relativeBoxContainerHover smallerSide smallerSideBtn"
            (click)="resetDeck()"
          >
            <img src="./assets/button.png" />
            <div class="btnText">Reset</div>
          </div>
        </div>
        <div class="absoluteCardsCountText">
          <div class="relativeBoxContainer smallerSide">
            <img src="./assets/shopBtnBg.png" />
            <div class="displayCountText">{{ abilityHand.length }}/16</div>
          </div>
        </div>
        <div class="cardsListBoxRight">
          <div class="cardsListRight">
            <div
              class="rightCard"
              *ngFor="let card of abilityHand; index as i; trackBy: trackById"
            >
              <div
                class="cardRelative"
                [ngStyle]="{
                  'z-index':5 +i,
                }"
              >
                <div
                  class="bottomCard playerBottomCard rightCard absoluteRightCard"
                  [ngClass]="{
                    darkenCard: !card.owned || (card.inHand && card.owned)
                  }"
                  *ngIf="
                    currentHoveringCard?.id === card.id &&
                    currentIndex === i &&
                    abilityHand.length > 1
                  "
                >
                  <div class="cardBorder">
                    <img
                      [src]="'./assets/abilities/' + card.image"
                      class="cardBackgroundImage"
                    />
                    <div
                      class="wildCardSuites bottomWildCard bottomAbilityStuff"
                    >
                      <div
                        class="abilityTitle"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      >
                        <div class="abilityTitleText">
                          {{ card.name }}
                          {{ card.level > 1 ? "+" + (card.level - 1) : "" }}
                        </div>
                        <div class="abilitySuitsBox">
                          <img
                            *ngFor="let cost of card.cost"
                            [src]="'./assets/' + cost + '.png'"
                            class="abilitySuit"
                          />
                        </div>
                      </div>
                      <div
                        class="abilityBorder1"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      ></div>
                      <div
                        class="abilityBorder2"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      ></div>
                      <div
                        class="abilityDescription"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      >
                        <div class="abilityDescriptionText">
                          {{ card.description }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  class="absoluteHoverBox"
                  (mouseenter)="currentHoveringCard = card; currentIndex = i"
                  (mouseleave)="
                    currentHoveringCard = undefined; currentIndex = -10
                  "
                  (dblclick)="removeCardFromHand(card)"
                ></div>
                <div
                  class="bottomCard playerBottomCard rightCard"
                  [ngClass]="{
                    darkenCard: !card.owned || (card.inHand && card.owned)
                  }"
                >
                  <div class="cardBorder">
                    <img
                      [src]="'./assets/abilities/' + card.image"
                      class="cardBackgroundImage"
                    />
                    <div
                      class="wildCardSuites bottomWildCard bottomAbilityStuff"
                    >
                      <div
                        class="abilityTitle"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      >
                        <div class="abilityTitleText">
                          {{ card.name }}
                          {{ card.level > 1 ? "+" + (card.level - 1) : "" }}
                        </div>
                        <div class="abilitySuitsBox">
                          <img
                            *ngFor="let cost of card.cost"
                            [src]="'./assets/' + cost + '.png'"
                            class="abilitySuit"
                          />
                        </div>
                      </div>
                      <div
                        class="abilityBorder1"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      ></div>
                      <div
                        class="abilityBorder2"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      ></div>
                      <div
                        class="abilityDescription"
                        [ngClass]="{
                        paperBg: card.level === 1,
                        paperBgRare: card.level === 2,
                        paperBgLegendary: card.level === 3,
                      }"
                      >
                        <div class="abilityDescriptionText">
                          {{ card.description }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="closeMenuButtonBox" (click)="checkCloseMenu()">
      <img src="./assets/close.png" class="closeMenuButton" />
      <img src="./assets/closeActive.png" class="closeMenuButton activeBtn" />
    </div>
  </div>

  <div class="checkSurrenderOverlay">
    <div
      class="surrenderMenuBackdrop"
      *ngIf="areYouSurePopup"
      [@fadeEnter]="{
        value: '',
        params: { duration: 500, delay: 0 }
      }"
      [@fadeOutLeave]="{
        value: '',
        params: { duration: 500, delay: 0 }
      }"
    ></div>
    <div
      class="checkSurrenderBox"
      *ngIf="areYouSurePopup"
      [@fadeEnter]="{
        value: '',
        params: { duration: 500, delay: 0 }
      }"
      [@fadeOutLeave]="{
        value: '',
        params: { duration: 500, delay: 0 }
      }"
    >
      <img class="checkSurrenderBg" src="./assets/box.png" />
      <div class="surrenderTitle">
        Are you sure? All unsaved changes will be lost.
      </div>
      <div class="surrenderBtns">
        <div class="finishButtonGo" (click)="areYouSurePopup = false">
          <img class="finishButton" [src]="'./assets/button.png'" />
          <div class="finishButtonText btnText biggerText">Cancel</div>
        </div>
        <div class="finishButtonGo" (click)="closeMenu()">
          <img class="finishButton" [src]="'./assets/button.png'" />
          <div class="finishButtonText btnText biggerText">Continue</div>
        </div>
      </div>
    </div>
  </div>
</div>
